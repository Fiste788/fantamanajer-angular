<div
  @createBox
  class="photo-container"
>
  <div class="img-container mat-elevation-z2">
    <img
      [alt]="val?.player?.full_name || placeholder"
      [defaultImage]="'/assets/clubs.svg#club-' + val?.club_id"
      [lazyLoad]="val?.player?.photo_url"
    >
  </div>
  <fm-member-icons
    *ngIf="val?.likely_lineup"
    @createBox
    [captain]="captain"
    [member]="val"
    [circle]="true"
  >
  </fm-member-icons>
</div>
<mat-form-field
  hideRequiredMarker="true"
  floatLabel="never"
  appearance="standard"
>
  <mat-select
    #memberSelection="ngModel"
    [disabled]="disabled"
    [placeholder]="placeholder"
    [attr.required]="required"
    [name]="name"
    [compareWith]="compareFn"
    [(ngModel)]="val"
    (blur)="onTouched()"
    (selectionChange)="change($event)"
  >
    <mat-option>{{placeholder}}</mat-option>
    <mat-select-trigger *ngIf="val">
      {{val.player.full_name}}
    </mat-select-trigger>
    <ng-container *ngIf="memberList?.length">
      <mat-option
        *ngFor="let opt of memberList; trackBy: track"
        [value]="opt.member"
        [disabled]="opt.disabled"
      >
        <fm-member-icons [member]="opt.member"></fm-member-icons>
      </mat-option>
    </ng-container>
    <ng-container *ngIf="memberMap">
      <mat-optgroup
        *ngFor="let role of (memberMap | keyvalue)"
        [label]="role.key.plural"
      >
        <mat-option
          *ngFor="let opt of role.value; trackBy: track"
          [value]="opt.member"
          [disabled]="opt.disabled"
        >
          <fm-member-icons [member]="opt.member"></fm-member-icons>
        </mat-option>
      </mat-optgroup>
    </ng-container>
  </mat-select>
  <mat-error *ngIf="memberSelection.errors?.required">Seleziona il giocatore</mat-error>
  <mat-hint *ngIf="val?.stats">
    <span>Ø P.ti: {{val.stats?.avg_points | number: '1.1-1'}}</span> -
    <span>Ø Voti: {{val.stats?.avg_rating | number: '1.1-1'}}</span> -
    <span>Σ Gol: {{val.role_id != 1 ? val.stats?.sum_goals : val.stats?.sum_goals_against}}</span>
  </mat-hint>
</mat-form-field>
